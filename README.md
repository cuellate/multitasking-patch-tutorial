## When all else fails: Hacky property list editing

"Hacky" because there's probably a reason the developer chose not to support that configuration.
Don't go complaining to the developer that this "support" doesn't work, because that's probably why it's _explicitly_ not supported in the first place.

This tutorial has been successfully used and tested on macOS. If you're on Windows, you'll need to find another way to run the commands in the entitlements step.

### Getting the Property List

1. Get to an IPA that you would like to patch.
2. We need to modify the IPA's contents. To do this, change the file extension to `.zip` and decompress it.
3. Inside the `Payload` folder, there will be an application with extension `.app`. Open it. To do that, you'll want to click "Show package contents" (which you can find in the two-finger click menu). 
4. There should be a file named `Info.plist`. Open it with your favorite code or plain-text editor (such as TextEdit which comes with macOS, but not a word-processor like Pages or Microsoft Word).

### Modifying the Property List

Now, we need to modify the property list with what we want to change.

To enable iPad support:
1. Look for a line that reads: `<key>UIDeviceFamily</key>`
2. Immediately following it, there should be:
```
<array>
<integer>1</integer>
<integer>2</integer>
</array>
```
3. Save and close the file.

To disable iPad support, simply remove the line that reads `<integer>2</integer>`.

To enable Split View and Side Over support:
1. It's enabled by default, so there must be a line disabling it. Look for a line that reads: `<key>UIRequiresFullScreen</key>`.
2. Immediately following it, change the `YES` to a `NO`.
3. Save and close the file.

### Entitlements Step (the hard work part)
Credit to [this StackOverflow answer](https://stackoverflow.com/questions/30791284/alter-minimum-os-version-of-ipa-without-xcode-ios-8/30864395#30864395) for the resources for this step.
1. Download the Python2 script found [here](https://web.archive.org/web/20111005022656/http://246tnt.com/iPhone/gen_entitlements.py)
2. Open Terminal, and change directory `cd` to the location of `gen_entitlements.py` (put it in the same folder with the Payload folder)
3. Run it with the following command (but replace `SJ87WGCZM7.com.matthewbenedict.instagram` with your bundle identifier): `python gen_entitlements.py SJ87WGCZM7.com.matthewbenedict.instagram instagram.xcent`
4. Ensure you have a signing certificate. You can find it (with its name) with this command: `security find-identity -v -p codesigning`
5. Run this codesign command to sign the app (don't use `~` in the paths, it won't work! replace the name with the name you found): `codesign -f -s "Apple Development: mbenedict2004@gmail.com (9ACBG9YARX)" --entitlements "/Users/matthewbenedict/Desktop/Instagram.xcent" "/Users/matthewbenedict/Desktop/Payload/Instagram.app"`
6. If step 5 crashed with `the codesign_allocate helper tool cannot be found or used` then run `sudo xcode-select -r` and try step 5 again.


### Repackaging the Application

1. Re-zip the `Payload` folder along with anything else that was in the IPA. The `Payload` folder MUST be at the top level of the IPA or it won't work, so if a folder was auto-generated by the OS, do NOT compress that.
2. Change the extension back to `.ipa`. 
3. Code-sign it with your favorite tool. This step should also put it onto the device in question. (If you need help finding a tool, [this post at /r/LegacyJailbreak](https://www.reddit.com/r/LegacyJailbreak/comments/jhjam8/tutorial_how_to_sideload_apps_ipas_used_for/ "this post at /r/LegacyJailbreak") has some nice tools.)

### Troubleshooting

Something went wrong? Try these suggestions in order (or at least do the last one last):

1. Did you put the Payload folder at the top level? If not, the OS will rightfully complain about it.
2. Does the app have strong jailbreak detection? If so, it might complain because you resigned it.
3. Did you use a word processor instead of a text editor? If so, the Info.plist is probably unreadable to the OS.
4. You did save everything, right?
5. Did you do the entitlements step (correctly)?
6. Let me know. Perhaps this tutorial wasn't foolproof enough for some pesky bug.
